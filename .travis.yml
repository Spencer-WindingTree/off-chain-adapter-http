dist: trusty
sudo: false
group: beta
language: node_js
node_js:
- 10.3.0
jobs:
  include:
  - stage: test
    script:
    - set -e
    - npm run flow
    - npm run lint
    - npm run test
    - npm run coverage
  - stage: NPM release
    if: tag IS present
    script: echo 'Deploying to NPM...'
    before_deploy: npm run build
    deploy:
      provider: npm
      email: chadima.jiri@gmail.com
      skip_cleanup: true
      api_key: "$NPM_TOKEN"
      on:
        repo: windingtree/off-chain-adapter-http
        tags: true
env:
  global:
  # NPM_TOKEN
  - secure: sP/VtGLV2KtQRT8u+zhwvlxVQY/sYZ5RyN90NIDyegbPtM36dQ1xouzQnFLsp3q7f95oLMm8i3s4w5bojR4Lxekjjtg0hMMx5WkK8uT74AMD8oysaGO4QcXFI9KaD2YviFO5KhgTTaR0FjSUiEBIoLV+cSMwe0f9MK8sNI++JlTwjnY3fnzP4IIj59fnjTjPhoLoKtNpe40ASy/DD/VzebfFwJoEY2C2Du8Brgb+CJHR/dzwRgd78pxUTCDn6pAtC8L7Ot7aHxOvKtnIFgq4dXvP6Td89MUfbjqOGkWgHI9dK0ccJhf+VmdU3uO2jwOQoGfueCipE1rPyRETaw2qXIzYIP3VBKhC2qoh9IVMXNLO11hF6JfYvZzmYRP9+VSw5QBypqjfkyHKkKRVMQchnZ57zAZAV/nGQW1IWQ3OLF5xs1OaHLGD9H6TAbwboRjWpNKvnPUxNE9jWVE76FmMq6JvFRy54pYNu9GJMMey2fyvFVsXF/DLaCZN0RFzAmIGgzyGivrc3wKQRugR+buRlI8UTjKuOJZVwOwsf6ttmdJ3qS3PaYzeeMQDlz7AHvgtgcGf7zDFDRDDQ2VgXNalX9zymsUceg8bC7iF2G8sdAMrqzHacEB6QJ4jcBzvPctlhE9/fXgkikSRxZFivoQUQ5OgLf6jnd7S+Fo5NE/5dRw=
